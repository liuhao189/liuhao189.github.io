# 微前端工程实现

## 前言

本文不论证做不做微前端，只谈如何实现微前端。

## 主应用和子应用

微前端在逻辑上需要将应用划分为主应用和子应用。

主应用功能包括：
1、注册子应用；
2、切换子应用（子应用生命周期以及子应用资源管理），沙盒机制；
4、公共展示区域（导航栏，header，footer，子应用占位元素等）；
5、子应用权限管理；
6、应用间共享的方法，数据，应用通信总线。

子应用功能包括：主要是业务页面。

    子应用应该按照业务或功能划分，尽量做到子应用独立，子应用之间不要有太多交互。

## 项目改造

### 打包构建

主应用打包构建和传统SPA 差异不大。

子应用打包构建和传统 SPA 主要是产物的区别。

传统SPA，构建产物为 HTML 文件和资源文件（CSS，JS，IMG等）。

子应用，构建产物只是资源文件（CSS，JS，IMG等），子应用入口文件需要导出特定函数以供主应用调用。

    子应用可以既编译为传统SPA，又编译为“微前端子应用”。这样子应用可以被独立使用。
  
### 本地开发

主应用本地开发和传统SPA类似。

子应用本地开发可以本地起该子应用的页面，本地开发测试完成后，部署到相应环境进行集成测试。

    如果想本地直接集成测试，可以将主应用页面起来，然后替换目前子应用资源地址。

### 开发规范

为了接入主应用以及更好得运行，子应用和主应用应该遵循的的规则。

### 接口改造

有了主应用后，所有请求都是主应用域名发出去的。对于一些子应用接口可能会存在跨域问题。

解决方案有两种：

1、子应用接口方支持CORS协议(nginx 配置即可)；

2、主应用服务器进行nginx代理。


## 微前端应用管理系统

微前端应用管理系统主要包括以下功能：

1、应用环境管理，test，stage，prod

2、应用管理，主应用创建&&编辑，子应用创建&&编辑

3、主应用菜单管理，eg：包含哪些子应用，哪些子应用页面

4、子应用资源管理，子应用菜单管理

5、对外接口，eg：子应用更新资源接口，主应用获取子应用接口

  




