<!DOCTYPE html>
<html>
<head>
  <title>Quill编辑器</title>
  <link rel="stylesheet" href="/note/note.css?ts=1635438331878">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><link rel="shortcut icon" href="/ico.png"></head>
<body><script>var _hmt = _hmt || [];
(function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?256376ad73e3e50091706bb3c032e74c";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
<h1 id="quill-">Quill编辑器</h1>
<pre><code class="lang-html"><div class="highlight"><pre><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span><span class="nt">&gt;</span>

<span class="nt">&lt;head&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">charset=</span><span class="s">&quot;UTF-8&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">http-equiv=</span><span class="s">&quot;X-UA-Compatible&quot;</span> <span class="na">content=</span><span class="s">&quot;IE=edge&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;meta</span> <span class="na">name=</span><span class="s">&quot;viewport&quot;</span> <span class="na">content=</span><span class="s">&quot;width=device-width, initial-scale=1.0&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;title&gt;</span>QuillEditor<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;link</span> <span class="na">href=</span><span class="s">&quot;https://cdn.bootcdn.net/ajax/libs/quill/2.0.0-dev.4/quill.snow.css&quot;</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">&quot;https://cdn.bootcdn.net/ajax/libs/quill/2.0.0-dev.4/quill.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="nt">&lt;/head&gt;</span>

<span class="nt">&lt;body&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;toolbar&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;ql-bold&quot;</span><span class="nt">&gt;</span>Bold<span class="nt">&lt;/button&gt;</span>
        <span class="nt">&lt;button</span> <span class="na">class=</span><span class="s">&quot;ql-italic&quot;</span><span class="nt">&gt;</span>Italic<span class="nt">&lt;/button&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">&quot;editor&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;p&gt;</span>Hello World!<span class="nt">&lt;/p&gt;</span>
    <span class="nt">&lt;/div&gt;</span>
    <span class="nt">&lt;script&gt;</span>
        <span class="kd">let</span> <span class="nx">editor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Quill</span><span class="p">(</span><span class="s1">&#39;#editor&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="nx">modules</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">toolbar</span><span class="o">:</span> <span class="s1">&#39;#toolbar&#39;</span>
            <span class="p">},</span>
            <span class="nx">theme</span><span class="o">:</span> <span class="s1">&#39;snow&#39;</span>
        <span class="p">})</span>
    <span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;/body&gt;</span>

<span class="nt">&lt;/html&gt;</span>
</pre></div>

</code></pre>
<h2 id="-">配置</h2>
<p>1、container，编辑器的容器，可以传递CSS选择器或DOM对象。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">let</span> <span class="nx">editor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Quill</span><span class="p">(</span><span class="s1">&#39;#editor&#39;</span><span class="p">);</span>
<span class="c1">//or</span>
<span class="kd">let</span> <span class="nx">editor2</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Quill</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;#editor&#39;</span><span class="p">));</span>
</pre></div>

</code></pre>
<p>2、options，为了配置Quill，传递的一个option对象。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">let</span> <span class="nx">options</span> <span class="o">=</span> <span class="p">{</span>
    <span class="nx">debug</span><span class="o">:</span> <span class="s1">&#39;info&#39;</span><span class="p">,</span>
    <span class="nx">modules</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">toolbar</span><span class="o">:</span> <span class="s1">&#39;#toolbar&#39;</span>
    <span class="p">},</span>
    <span class="nx">placeholder</span><span class="o">:</span> <span class="s1">&#39;input something...&#39;</span><span class="p">,</span>
    <span class="nx">readOnly</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span>
    <span class="nx">theme</span><span class="o">:</span> <span class="s1">&#39;snow&#39;</span>
<span class="p">}</span>
<span class="kd">let</span> <span class="nx">editor</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Quill</span><span class="p">(</span><span class="s1">&#39;#editor&#39;</span><span class="p">,</span> <span class="nx">options</span><span class="p">);</span>
</pre></div>

</code></pre>
<h3 id="options-">options可配置项</h3>
<p>1、bounds(默认：document.body)，目前只检测左右边界。</p>
<p>2、debug(默认：warn)，debug是一个静态配置，会影响到其它的Quill实例。</p>
<p>3、formats(默认：All formats)，formats的白名单。</p>
<p>4、modules，模块列表。</p>
<p>5、placeholder，编辑器没有内容时展示的信息。</p>
<p>6、readOnly，是否以只读的模式初始化编辑器。</p>
<p>7、scrollingContainer，DOM对象或CSS选择器。</p>
<p>8、theme，主题名称，自带的主题有bubble和snow。注意，主题的css文件需要额外加载。</p>
<h2 id="formats">Formats</h2>
<p>Quill支持一系列的formats，既包括UI控件，又可以API调用。</p>
<h3 id="inline-formats">Inline Formats</h3>
<p>background，bold，color，font，code，italic，link，size，strike，script，underline。</p>
<h3 id="block-formats">Block Formats</h3>
<p>blockquote，header，indent，list，align，direction，code-block。</p>
<h3 id="embeds">Embeds</h3>
<p>formula(require KaTex)，image，video。</p>
<h2 id="api">API</h2>
<h3 id="content">Content</h3>
<h4 id="deletetext">deleteText</h4>
<p>从编辑器中删除文本，返回一个Delta代表这个变更。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">deleteText</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="c1">// delta is {ops:[{retain:1},{delete:2}]}</span>
</pre></div>

</code></pre>
<h4 id="getcontents">getContents</h4>
<p>返回编辑器的内容，带有格式化信息，返回delta对象。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getContents</span><span class="p">()</span>
<span class="c1">// deleta is { ops: [ {insert: `Hello \n`}, { attributes: {bold: true}, insert: `world!\n`} ] }</span>
</pre></div>

</code></pre>
<h4 id="getlength">getLength</h4>
<p>返回编辑器内容的长度。注意：即使编辑器是空的，也有\n换行符。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="nx">editor</span><span class="p">.</span><span class="nx">getLength</span><span class="p">();</span>
</pre></div>

</code></pre>
<h4 id="gettext">getText</h4>
<p>返回编辑器的文本内容，非字符内容会省略。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getText(index: Number=0,length:Number):String</span>
<span class="kd">let</span> <span class="nx">text</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="insertembed">insertEmbed</h4>
<p>在编辑器中插入嵌入的内容，返回一个delta。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// insertEmbed(index:Number,type:String, value:any, source:String=&#39;api&#39;):Delta</span>
<span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">insertEmbed</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;https://ftp.bmp.ovh/imgs/2021/10/331197ebc7c14fbb_thumb.jpg&#39;</span><span class="p">)</span>
<span class="c1">//deleta is {ops: [{retain:10},{insert:{image: &#39;https://ftp.bmp.ovh/imgs/2021/10/331197ebc7c14fbb_thumb.jpg&#39;}}]}</span>
</pre></div>

</code></pre>
<h4 id="inserttext">insertText</h4>
<p>在编辑器中插入文本，可以以多种格式插入，返回一个delta。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// insertText(index:Number,text:String,source:String=&#39;api&#39;):Delta</span>
<span class="c1">// insertText(index:Number,text:String,format:String, value:any, source:String =&#39;api&#39;):Delta</span>
<span class="c1">// insertText(index:Number,text:String,format:{[String]:any},source:String=&#39;api&#39;):Delta</span>
<span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">insertText</span><span class="p">(</span><span class="mi">26</span><span class="p">,</span> <span class="err">`</span><span class="nx">Hello</span><span class="err">`</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span>
    <span class="nx">italic</span><span class="o">:</span> <span class="kc">true</span>
<span class="p">})</span>
<span class="c1">// delta is {ops:[{retain:26},{attributes: {color: &#39;red&#39;, italic: true},insert:`Hello`}]}</span>
</pre></div>

</code></pre>
<h4 id="setcontents">setContents</h4>
<p>设置编辑器当前的内容，内容应该以换行符\n结尾。返回一个delta对象。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//setContents(delta:Delta, source:String = &#39;api&#39;):Delta</span>
<span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">setContents</span><span class="p">([{</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;Hello &#39;</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;world!&#39;</span><span class="p">,</span>
    <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span>
        <span class="nx">bold</span><span class="o">:</span> <span class="kc">true</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="p">{</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;\n&#39;</span>
<span class="p">}])</span>
<span class="c1">//delta is  {ops: [{insert: &#39;Hello &#39;}, {attributes: {bold: true}, insert:&#39;world!&#39;}, {insert: &#39;\n&#39;}, {delete: 1} ]}</span>
</pre></div>

</code></pre>
<h4 id="settext">setText</h4>
<p>设置编辑器的文本内容，返回一个delta。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//setText(text : String,source : String = &#39;api&#39;): Delta</span>
<span class="kd">let</span> <span class="nx">delta</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">setText</span><span class="p">(</span><span class="err">`</span><span class="nx">Hello</span><span class="err">\</span><span class="nx">n</span><span class="err">`</span><span class="p">)</span>
<span class="c1">// delta is {ops:[ {insert: &#39;Hello\n&#39;}, {delete: 13}]}</span>
</pre></div>

</code></pre>
<h4 id="updatecontents">updateContents</h4>
<p>用delta去更新编辑器内容，返回一个反映变化的Delta。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//updateContents(delta:Delta, source:String =&#39;api&#39;): Delta</span>

<span class="nx">editor</span><span class="p">.</span><span class="nx">updateContents</span><span class="p">({</span>
    <span class="nx">ops</span><span class="o">:</span> <span class="p">[{</span>
            <span class="nx">retain</span><span class="o">:</span> <span class="mi">6</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="k">delete</span><span class="o">:</span> <span class="mi">5</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;Quill&#39;</span>
        <span class="p">},</span>
        <span class="p">{</span>
            <span class="nx">retain</span><span class="o">:</span> <span class="mi">3</span><span class="p">,</span>
            <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span>
                <span class="nx">bold</span><span class="o">:</span> <span class="kc">true</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">]</span>
<span class="p">});</span>
<span class="c1">// ops:</span>
<span class="c1">// 0: {retain: 6}</span>
<span class="c1">// 1: {insert: &#39;Qui&#39;}</span>
<span class="c1">// 2: {delete: 3}</span>
<span class="c1">// 3: {retain: 1}</span>
<span class="c1">// 4: {insert: &#39;l&#39;}</span>
<span class="c1">// 5: {delete: 1}</span>
<span class="c1">// 6: {retain: 1, attributes: { bold: true }}}</span>
</pre></div>

</code></pre>
<h3 id="formatting">Formatting</h3>
<h4 id="format">format</h4>
<p>格式化用户当前选择的内容，返回一个代表变更的Delta。如果用户选择的内容为空，格式化被激活，用户下一个输入的字符会被格式化。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// format(name:String, value: any, source:String = &#39;api&#39;): Delta</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">format</span><span class="p">(</span><span class="s1">&#39;color&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">);</span>
<span class="c1">//ops: </span>
<span class="c1">// 0: {retain: 6}</span>
<span class="c1">// 1: {retain: 5, attributes: { color: red}}</span>
</pre></div>

</code></pre>
<h4 id="formatline">formatLine</h4>
<p>格式化所有的选定行，返回一个代表变更的Delta。如果传递inline formats，没有任何效果。移除格式化信息，Value传递false参数即可。用户选择信息可能不会保留。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//formatLine(index:Number, length: Number, source:String = &#39;api&#39;):Delta</span>
<span class="c1">//formatLine(index:Number, length: Number, format:String , value:any, source:String = &#39;api&#39;):Delta</span>
<span class="c1">//formatLine(index:Number, length: Number, formats: {[String]: any}, source: String = &#39;api&#39;):Delta</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">formatLine</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;align&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">);</span>
<span class="c1">//0: {retain: 12}</span>
<span class="c1">// 1: {retain: 1, attributes: {align: `right`} }</span>
</pre></div>

</code></pre>
<h4 id="formattext">formatText</h4>
<p>格式化编辑器里的文本，返回代表变更的Delta。移除样式，value传递为false即可，用户的选择可能不会保留。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//formatText(index:Number, length:Number, source:String = &#39;api&#39;):Delta</span>
<span class="c1">//formatText(index:Number, length:Number, format:String, value:any, source:String = &#39;api&#39;): Delta</span>
<span class="c1">//formatText(index:Number, length:Number, formats:{String]: any}, source:String = &#39;api&#39;): Delta</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">formatText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="c1">//ops: [{ attributes: {bold: true}, retain: 5}]</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">formatText</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">{</span>
    <span class="s1">&#39;bold&#39;</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="s1">&#39;color&#39;</span><span class="o">:</span> <span class="s1">&#39;rgb(0, 0, 255)&#39;</span>
<span class="p">});</span>
<span class="c1">//ops:[ {attributes: {bold: null, color: &#39;red&#39;}, retain: 5}]</span>
</pre></div>

</code></pre>
<h4 id="getformat">getFormat</h4>
<p>得到所选择文本的格式化信息，所有区域内的所有文本必须有该format值。返回一个name为format，key为true的对象。如果没有传递范围，则用户当前选择的文本范围会被使用。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getFormat(range:Range = current): {[String]: any}</span>
<span class="c1">//getFormat(index:Number, length:Number=0): {[String]: any}</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getFormat</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="c1">// { bold: true, italic: true }</span>
</pre></div>

</code></pre>
<h4 id="removeformat">removeFormat</h4>
<p>移除所有的的格式和嵌入的内容，返回一个代表变更的Delta对象。如果选区内的所有文字都有该format，则line format会被移除。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// removeFormat(index: Number, length: Number, source:String = &#39;api&#39;):Delta</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">removeFormat</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="c1">// {ops: [{retain: 6, attributes: { bold: null}},...{ retain:1, attributes: {italic:null} }]}</span>
</pre></div>

</code></pre>
<h3 id="selection">Selection</h3>
<h4 id="getbounds">getBounds</h4>
<p>获取相对于编辑器的绝对位置和大小信息。在用于计算展示悬浮框的位置时很有效。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getBounds(index:Number, length: Number =0): {left: Number, top: Number, height: Number, width: Number}</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getBound</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">);</span>
<span class="c1">//{ bottom: 28,</span>
<span class="c1">// height: 15,</span>
<span class="c1">// left: 16,</span>
<span class="c1">// right: 82.96875,</span>
<span class="c1">// top: 13,</span>
<span class="c1">// width: 66.96875 }</span>
</pre></div>

</code></pre>
<h4 id="getselection">getSelection</h4>
<p>获取用户的选中区域。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getSelection(focus = false): {index:Number, length:Number}</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getSelection</span><span class="p">()</span>
<span class="c1">// { index: 1, length: 20}</span>
</pre></div>

</code></pre>
<h4 id="setselection">setSelection</h4>
<p>选中给定的区域，这个会focus编辑器。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//setSelection(index:Number, length:Number =0 , source:String = &#39;api&#39;)</span>
<span class="c1">//setSelection(range: {index: Number, length:Number},source:String = &#39;api&#39;)</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">setSelection</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
</pre></div>

</code></pre>
<h3 id="editor">Editor</h3>
<h4 id="blur">blur</h4>
<p>使编辑器失去焦点。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="nx">editor</span><span class="p">.</span><span class="nx">blur</span><span class="p">()</span>
</pre></div>

</code></pre>
<h4 id="disable">disable</h4>
<p>等同于enable(false)</p>
<h4 id="enable">enable</h4>
<p>设置用户是否可以通过键盘或鼠标编辑。不影响通过API调用的编辑。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="nx">enable</span><span class="p">(</span><span class="nx">enabled</span><span class="o">:</span> <span class="kr">boolean</span> <span class="o">=</span> <span class="kc">true</span><span class="p">)</span>
</pre></div>

</code></pre>
<h4 id="focus">focus</h4>
<p>focus编辑器，恢复最后的选区。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="nx">editor</span><span class="p">.</span><span class="nx">focus</span><span class="p">()</span>
</pre></div>

</code></pre>
<h4 id="hasfocus">hasFocus</h4>
<p>编辑器是否focus，焦点在toolbar，tooltips不算focus在编辑器。</p>
<h4 id="update">update</h4>
<p>同步检查是否有用户更新，如果有变动，则生成相关的事件。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="nx">editor</span><span class="p">.</span><span class="nx">update</span><span class="p">(</span><span class="nx">source</span><span class="o">:</span> <span class="nb">String</span> <span class="o">=</span> <span class="s1">&#39;user&#39;</span><span class="p">)</span>
</pre></div>

</code></pre>
<h3 id="events">Events</h3>
<h4 id="text-change">text-change</h4>
<p>当内容变更时触发，变化的具体内容，变化前的编辑器，变化源会被提供。</p>
<p>如果变化的source为slient，则text-change事件不会被触发。这种方式不被推荐，因为它会破坏undo堆栈和其它依赖于变化记录的功能。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// handler(delta:Delta, oldContents:Delta, source:string)，事件处理器参数</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;text-change&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">delta</span><span class="p">,</span> <span class="nx">oldDelta</span><span class="p">,</span> <span class="nx">source</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">delta</span><span class="p">,</span> <span class="nx">oldDelta</span><span class="p">,</span> <span class="nx">source</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>

</code></pre>
<h4 id="selection-change">selection-change</h4>
<p>当选中的区域变化时，该事件会被触发，事件中包含选中的区域。返回null代表选区丢失，一般是编辑器失去焦点导致的。</p>
<p>如果source为slient，该事件也不会触发。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//handler(range:{index:Number,length:Number},oldRange: {index:Number,length:Number}, source:String)</span>
<span class="c1">// 事件处理方法参数类型</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;selection-change&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">oldRange</span><span class="p">,</span> <span class="nx">source</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">range</span><span class="p">,</span> <span class="nx">oldRange</span><span class="p">,</span> <span class="nx">source</span><span class="p">);</span>
<span class="p">})</span>
</pre></div>

</code></pre>
<h4 id="editor-change">editor-change</h4>
<p>text-change或selection-change事件都会被触发。source为slient，也会触发。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//handler(name:String, ...args)</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">on</span><span class="p">(</span><span class="s1">&#39;editor-change&#39;</span><span class="p">,</span> <span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="p">...</span><span class="nx">args</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">eventName</span><span class="p">,</span> <span class="nx">args</span><span class="p">)</span>
<span class="p">})</span>
</pre></div>

</code></pre>
<h4 id="on-off-once">on &amp;&amp; off &amp;&amp; once</h4>
<p>添加事件处理器。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// on(name:String, handler:Function): Quill</span>
<span class="c1">// once(name:String,handler:Function): Quill</span>
<span class="c1">// off(name:String, handler:Function): Quill</span>
</pre></div>

</code></pre>
<h3 id="model">Model</h3>
<h4 id="find">find</h4>
<p>静态方法，返回给定的DOM节点管理的Quill或Blot实例。第二个参数buddle代表是否需要搜寻给定DOM节点的祖先节点。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Quill.find(domNode:Node, buddle: boolean = false): Blot| Quill</span>
</pre></div>

</code></pre>
<h4 id="getindex">getIndex</h4>
<p>返回给定的Blot距文档开始的距离。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getIndex(blot:Blot):Number</span>
<span class="kd">let</span> <span class="nx">codeBlot</span> <span class="o">=</span> <span class="nx">Quill</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="nx">$0</span><span class="p">)</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getIndex</span><span class="p">(</span><span class="nx">codeBlot</span><span class="p">)</span>
<span class="c1">//</span>
</pre></div>

</code></pre>
<h4 id="getleaf">getLeaf</h4>
<p>返回在特定Index位置的子Blot。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getLeaf(index:Number):Blot</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getLeaf</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
</pre></div>

</code></pre>
<h4 id="getline">getLine</h4>
<p>返回在指定Index的line Blot。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getLine(index:Number):[Blot,Number]</span>
<span class="kd">let</span> <span class="p">[</span><span class="nx">lineBlot</span><span class="p">,</span> <span class="nx">offset</span><span class="p">]</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">getLine</span><span class="p">(</span><span class="mi">7</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="getlines">getLines</h4>
<p>返回在特定区间的Line Blot数组。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// getLines(index: Number =0, length:Number=remaining): Blot[]</span>
<span class="c1">// getLines(range: Range): Blot[]</span>
<span class="nx">editor</span><span class="p">.</span><span class="nx">getLines</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">)</span>
</pre></div>

</code></pre>
<h3 id="extension">Extension</h3>
<h4 id="debug">debug</h4>
<p>静态方法来启用特定的打印消息级别。error，warn，log，info。true为log，false为取消所有log。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// Quill.debug(level: String| Boolean)</span>
</pre></div>

</code></pre>
<h4 id="import">import</h4>
<p>静态方法，主要用来获取Quill内部的lib，format，module和theme。参数path需要和Quill源码的目录结构一致。</p>
<p>修改返回的内容非常不推荐，因为可能会导致Quill的正常功能受损。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Quill.import(path):any</span>
<span class="kd">let</span> <span class="nx">Delta</span> <span class="o">=</span> <span class="nx">Quill</span><span class="p">.</span><span class="kr">import</span><span class="p">(</span><span class="s1">&#39;delta&#39;</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">Toolbar</span> <span class="o">=</span> <span class="nx">Quill</span><span class="p">.</span><span class="kr">import</span><span class="p">(</span><span class="s1">&#39;modules/toolbar&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="register">register</h4>
<p>注册一个module，theme，format，使得他们可以添加到编辑器中。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//Quill.register(format:Attributor | BlotDefinintion, supressWarning: Boolean = false )</span>
<span class="c1">//Quill.register(path: String, def: any, supressWarning:Boolean = false)</span>
<span class="c1">//Quill.register(defs:{[String]:any}, supressWarning: Boolean = false)</span>
<span class="kd">let</span> <span class="nx">Module</span> <span class="o">=</span> <span class="nx">Quill</span><span class="p">.</span><span class="kr">import</span><span class="p">(</span><span class="s1">&#39;core/module&#39;</span><span class="p">)</span>
<span class="kr">class</span> <span class="nx">CustomModule</span> <span class="kr">extends</span> <span class="nx">Module</span> <span class="p">{}</span>
<span class="nx">Quill</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="err">`</span><span class="nx">modules</span><span class="o">/</span><span class="nx">custom</span><span class="o">-</span><span class="nx">module</span><span class="err">`</span><span class="p">,</span> <span class="nx">CustomModule</span><span class="p">)</span>
<span class="nx">Quill</span><span class="p">.</span><span class="nx">register</span><span class="p">({</span>
    <span class="err">`</span><span class="nx">formats</span><span class="o">/</span><span class="nx">custom</span><span class="o">-</span><span class="nx">format</span><span class="err">`</span><span class="o">:</span> <span class="nx">CustomFormat</span><span class="p">,</span>
    <span class="err">`</span><span class="nx">formats</span><span class="o">/</span><span class="nx">custom</span><span class="o">-</span><span class="nx">module</span><span class="o">-</span><span class="nx">a</span><span class="err">`</span><span class="o">:</span> <span class="nx">CustomModuleA</span>
<span class="p">});</span>
<span class="nx">Quill</span><span class="p">.</span><span class="nx">register</span><span class="p">(</span><span class="nx">CustomFormat</span><span class="p">)</span>
</pre></div>

</code></pre>
<h4 id="addcontainer">addContainer</h4>
<p>添加一个容器元素在Quill编辑器内。习惯上，Quill模块需要有一个ql-前缀的class名。第二个参数为refNode，container会在它之前插入。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">// editor.addContainer(className:String, refNode?: Node) : Element</span>
<span class="c1">// editor.addContainer(domNode:Node, refNode?: Node): Element</span>
<span class="kd">let</span> <span class="nx">container</span> <span class="o">=</span> <span class="nx">editor</span><span class="p">.</span><span class="nx">addContainer</span><span class="p">(</span><span class="s1">&#39;ql-custom&#39;</span><span class="p">);</span>
</pre></div>

</code></pre>
<h4 id="getmodule">getModule</h4>
<p>返回添加到编辑器的module。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="c1">//getModule(name:String):any</span>
<span class="kd">let</span> <span class="nx">toolbar</span> <span class="o">=</span> <span class="nx">quill</span><span class="p">.</span><span class="nx">getModule</span><span class="p">(</span><span class="s1">&#39;toolbar&#39;</span><span class="p">)</span>
</pre></div>

</code></pre>
<h2 id="delta">Delta</h2>
<p>Delta是一种简单和富于表现力的，用来描述Quill编辑器的内容和变更的一种格式。</p>
<p>Delta是JSON的严格子集，是人类易读取的，机器容易解析的格式。Delta可表示任何Quill文档，包括所有文本和format信息。</p>
<p>Delta在英文中表示增量，在Quill中用于表示从一个文档变换到另外一个文档需要经过的指令集合。</p>
<p>Delta实现为一个独立的类库，使其可以独立于Quill使用。它可以用于OT，也可以被应用于类似Google Docs之列的应用。</p>
<p>提示：不推荐直接手写Delta，可以使用import来得到Delta，然后使用Delta.insert，Delta.delte，Delta.retain等方法。</p>
<h2 id="document">Document</h2>
<pre><code class="lang-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="nx">ops</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;Gandalf&#39;</span><span class="p">,</span> <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">bold</span><span class="o">:</span> <span class="kc">true</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39; the &#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;Grey&#39;</span><span class="p">,</span> <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">color</span><span class="o">:</span> <span class="s1">&#39;#cccccc&#39;</span> <span class="p">}</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>

</code></pre>
<p>当Delta用于描述内容时，它可以被认为是需要应用于空白文档的增量。因为Delta是一种数据格式，attributes没有特定的意义，名字和值完全取决于使用者和生成者。</p>
<p>eg：color不一定非是16进制的值，这个只是Quill做出的一种选择。</p>
<h2 id="embeds">Embeds</h2>
<p>对于一些非文办内容，比如说图片或公式，insert的值可以是一个对象。</p>
<p>这个对象需要有一个来决定它类型的key，这个是BlotName（如果你使用Parchment来构建自定义内容）。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="nx">ops</span><span class="o">:</span> <span class="p">[{</span>
    <span class="nx">insert</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">image</span><span class="o">:</span> <span class="s1">&#39;https://quilljs.com/assets/images/icon.png&#39;</span>
    <span class="p">},</span>
    <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">link</span><span class="o">:</span> <span class="s1">&#39;https://quilljs.com&#39;</span>
    <span class="p">}</span>
  <span class="p">}]</span>
<span class="p">}</span>
</pre></div>

</code></pre>
<h2 id="line-formatting">Line Formatting</h2>
<p>与\n字符相关的attributes表示行的format。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="p">{</span>
  <span class="nx">ops</span><span class="o">:</span> <span class="p">[</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;The Two Towers&#39;</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;\n&#39;</span><span class="p">,</span> <span class="nx">attributes</span><span class="o">:</span> <span class="p">{</span> <span class="nx">header</span><span class="o">:</span> <span class="mi">1</span> <span class="p">}</span> <span class="p">},</span>
    <span class="p">{</span> <span class="nx">insert</span><span class="o">:</span> <span class="s1">&#39;Aragorn sped on up the hill.\n&#39;</span> <span class="p">}</span>
  <span class="p">]</span>
<span class="p">}</span>
</pre></div>

</code></pre>
<p>所有的Quill文档需要以\n结尾，因为这样你永远会有一个位置来应用行格式。</p>
<p>很多行格式是不可同时设置的。eg：同一行既是header，又是list。</p>
</body>
</html>
