<!DOCTYPE html>
<html>
<head>
  <title>Electron-mksnapshot</title>
  <link rel="stylesheet" href="/note/note.css?ts=1647965925670">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><link rel="shortcut icon" href="/ico.png"></head>
<body><script>var _hmt = _hmt || [];
(function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?256376ad73e3e50091706bb3c032e74c";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
<h1 id="electron-mksnapshot">Electron-mksnapshot</h1>
<p>下载与Electron兼容的mksnapshot二进制文件来生成V8-snapshot的npm包。</p>
<p>这个npm包的主版本跟随Electron的主版本。如果你使用<a href="mailto:Electron@17.0.x">Electron@17.0.x</a>，你需要使用<a href="mailto:electron-mksnapshot@17.0.x">electron-mksnapshot@17.0.x</a>。</p>
<h2 id="-">使用</h2>
<pre><code class="lang-bash"><div class="highlight"><pre><span class="c"># install</span>
npm install electron-mksnapshot --save-dev
<span class="c"># use</span>
mksnapshot.js file.js --out_dir OUTPUT_DIR
</pre></div>

</code></pre>
<p>mksnapshot会生成snapshot_blob.bin和v8_context_snapshots.bin文件。这两个文件都需要拷贝到Electron的特定目录中。</p>
<p>mksnapshot的命令行参数支持除--start_blob外的参数，可以执行mksnapshot --help来查看。</p>
<h2 id="-">自定义镜像</h2>
<p>你可以设置ELECTRON_MIRROT或NPM_CONFIG_ELECTRON_MIRROR的环境变量来定义下载mksnapshot的地址。</p>
<pre><code class="lang-bash"><div class="highlight"><pre><span class="c"># for china</span>
<span class="nv">ELECTRON_MIRROR</span><span class="o">=</span><span class="s2">&quot;https://npm.taobao.org/mirrors/electron/&quot;</span>
<span class="c"># for local</span>
<span class="nv">ELECTRON_MIRROR</span><span class="o">=</span><span class="s2">&quot;http://localhost:8080/&quot;</span>
</pre></div>

</code></pre>
<h2 id="-">自定义下载的版本</h2>
<p>可以使用ELECTRON_CUSTOM_VERSION环境变量来设置需要下载的版本。</p>
<pre><code class="lang-bash"><div class="highlight"><pre><span class="c"># install mksnapshot for electron v8.3.0</span>
<span class="nv">ELECTRON_CUSTOM_VERSION</span><span class="o">=</span>8.3.0 npm install
</pre></div>

</code></pre>
<h2 id="-arm-">生成ARM硬件的快照</h2>
<p>如果你需要生成面向Linux_arm32，Linux_arm64，win32_arm64的snapshots，你需要在Intel X64平台上安装一个跨架构的mksnapshot。</p>
<p>Linux_arm64 &amp; windows_arm64 &amp; macOS_arm64</p>
<pre><code class="lang-bash"><div class="highlight"><pre><span class="c"># Intel x64 Linux OS run</span>
npm config <span class="nb">set </span>arch arm64
npm install --save-dev electron-mksnapshot
</pre></div>

</code></pre>
<p>Linux_arm71(32位arm)</p>
<pre><code class="lang-bash"><div class="highlight"><pre><span class="c"># Intel X64 Linux OS</span>
npm config <span class="nb">set </span>arch arm71
npm install --save-dev electron-mksnapshot
</pre></div>

</code></pre>
<h2 id="-">参考文档</h2>
<p><a href="https://www.npmjs.com/package/electron-mksnapshot">https://www.npmjs.com/package/electron-mksnapshot</a></p>
</body>
</html>
