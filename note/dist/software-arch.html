<!DOCTYPE html>
<html>
<head>
  <title>软件架构模式</title>
  <link rel="stylesheet" href="/note/note.css?ts=1642349754312">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><link rel="shortcut icon" href="/ico.png"></head>
<body><script>var _hmt = _hmt || [];
(function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?256376ad73e3e50091706bb3c032e74c";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
<h1 id="-">软件架构模式</h1>
<p>本文观点和内容参考了《Software Architecture Patterns》的书。</p>
<h2 id="-">为什么要学习基本的软件架构</h2>
<p>1、了解了基本的软件架构知识，你可以更容易理解你所工作的软件项目。</p>
<p>2、知道基础的架构模式可以让你在写代码时做更好的决策。eg：如果你的应用基于事件驱动的微服务，那么做为软件工程师你必须将越来越复杂的代码拆分为独立的服务。</p>
<h2 id="-">五种模式</h2>
<p>1、分层结构。</p>
<p>2、事件驱动结构。</p>
<p>3、微内核架构或插件结构。</p>
<p>4、微服务体系结构。</p>
<p>5、云架构模式。</p>
<h2 id="-">分层结构</h2>
<p>对于单体应用来说，是最常见的软件结构。该模式背后的基本思想是将应用程序逻辑分为几个层，每个层封装特定类型的功能。</p>
<p>eg：持久化层负责app和db的通讯。</p>
<p><img src="/note/assets/imgs/layer-software-arch.png" alt="分层结构图"></p>
<h2 id="-">事件驱动结构</h2>
<p>该模式背后的基本思想是将应用程序分为单一职责的事件处理组件。该组件可以接收并处理事件。</p>
<p>该模式是一种流行的分布式异步体系结构模式，以高可扩展性和适应性而闻名。</p>
<p><img src="/note/assets/imgs/event-software-arch.png" alt="事件驱动结构图"></p>
<h2 id="-">微内核结构或插件结构</h2>
<p>微内核结构，也被称为插件结构。在设计时分为两个组件：核心系统和插件模式。一个比较好的例子是浏览器，你可以安装很多浏览器插件。</p>
<p><img src="/note/assets/imgs/plugin-software-arch.png" alt="插件结构图"></p>
<h2 id="-">微服务结构</h2>
<p>微服务体系结构由单独部署的服务组成，其中每个服务都有单一的职责。这些服务是彼此独立的，如果一个服务失败，其它服务不会停止运行。</p>
<p><img src="/note/assets/imgs/microservices-software-arch.png" alt="微服务结构图"></p>
<h2 id="-">基于空间的结构</h2>
<p>基于空间的模式背后的主要思想是分布式共享内存，以缓解数据库级别经常出现的问题。我们的假设是，通过使用内存中的数据处理大多数操作，我们可以避免数据库中的额外操作，从而避免将来可能出现的任何问题。</p>
<p>基本方式是将应用程序划分为多个处理单元(可根据需要自动放大和缩小)，在这些单元之间复制和处理数据，而无需将数据持久化到中央数据库。</p>
<p><img src="/note/assets/imgs/space-software-arch.png" alt="基于空间的结构图"></p>
<h1 id="-">软件架构模式</h1>
<p>开发人员在没有正式的体系结构的情况下开始编写应用程序是很常见的。</p>
<p>如果没有清晰且定义良好的体系结构，大多数开发人员和架构师将求助于事实上的标准传统分层体系结构模式。</p>
<p>通过将源代码模块分离到包中来创建隐式层，不幸的是，这种做法会产生一系列无组织的源代码模块，它们之间缺乏明确的角色、责任和关系。这被称为大泥球反模式架构。</p>
<p>缺乏正式体系结构的应用程序通常是紧密耦合的、脆弱的，难以变更的，并且没有明确的愿景和方向。</p>
<p>不充分了解系统中每个组件和模块的内部工作原理，就很难确定应用程序的体系结构特征。关于部署和维护的基本问题很难回答。eg：架构是否可以扩展？应用程序的性能特征是什么？应用程序响应变更的难易程度？<br>应用程序的部署特征是什么？体系结构的响应能力如何？</p>
<p>架构模式有助于定义应用程序的基本特征和行为。eg：一些架构模式适用于高度可伸缩，其它架构适用于高度敏捷的应用程序。了解每种架构模式的优点和缺点对于选型至关重要。</p>
<p>作为架构师，你必须始终证明您的体系结构决策是正确的，尤其是在选择特定的体系结构模式或方法时。</p>
<h2 id="-">分层架构</h2>
<p>最常见的架构模式是分层架构模式。分层架构和大多数公司的组织结构紧密匹配，使其称为大多数业务应用程序开发工作的自然选择。</p>
<p>分层体系架构中的组件被组织成水平层，每个层执行特定的功能。eg：表示逻辑和业务逻辑。</p>
<p>大多数分层架构的软件分为四层，表现层，业务层，持久化层，DB层。</p>
<p>每一层有特定的功能。eg：表现层会处理所有用户发起的请求。业务层执行请求关联的业务逻辑。</p>
<p>分层架构模式的一个强大特性是组件之间的关注点分离。</p>
<p>分层体系中的每个层都标记为已关闭，这是分层体系架构中非常重要的概念。封闭层意味着当请求从一层移动到另一层时，必须穿过它正下方的层。</p>
<p>为什么不允许表示层直接访问持久层或数据层呢？这个问题的答案在于隔离层的关键概念。</p>
<p>隔离层概念意味着在体系结构中的一个层所做的更改通常不会影响其它层的组件，该更改被隔离到该层中的组件，只有可能影响到关联层。如果不这样，就会产生一个组件之间有大量相互依赖关系的紧密耦合的应用程序，这种类型的体系结构很难改变。</p>
<p>隔离层的概念还意味着每个层独立于其它层，因此对体系结构中的其它层的内部工作知之甚少或一无所知。eg：考虑将JSP转换为JSF。</p>
<p>虽然封闭层有助于隔离，但是某些层是开放的是有意义的。eg：共享服务层添加到包含业务层中的公共服务组件（数据和字符串应用程序类，审核和日志类）。创建服务层通常是一个好主意，因为它将对共享服务的访问限制在业务层上。</p>
<p><img src="/note/assets/imgs/open-layer-software-arch.png" alt="开放分层结构图"></p>
<p>利用开放层和封闭层的概念有助于定义体系架构层和请求流之间的关系。</p>
<h3 id="-">分层结构特点</h3>
<p>分层结构是一种可靠的通用模式，当您不确定哪种体系结构最适合您的应用时，可以先采用此模式。</p>
<p>但有两个方面需要考虑。</p>
<p>首先要注意的是所谓的体系结构的反模式。eg：请求通过架构的多个层，但多个层只作简单的传递处理，在每一层执行很少或没有逻辑。</p>
<p>每一个分层结构都至少有一些场景属于反模式，关键是分析百分比。如果发现大部分请求都是简单得传递处理，可能需要考虑将一些体系架构层打开。</p>
<p>第二个考虑因素是分层架构倾向于单体应用程序。</p>
<h3 id="-">模式分析</h3>
<p>1、整体敏捷性：差，虽然有隔离层，但由于大多数实现的整体性以及通常的组件紧耦合，该体系结构中进行更改仍非常繁琐和耗时。</p>
<p>2、易于部署：差，部署可能会成为一个问题。组件的一个小更改可能需要重新部署整个应用程序。</p>
<p>3、可测试性：高，其它层可以被很容易模拟，使得此模式相对容易测试。</p>
<p>4、性能：低，由于必须通过体系结构的多个层来处理。</p>
<p>5、可伸缩性：低，由于该模式的紧密耦合和单体应用实现的趋势。可以通过将层拆分为单独的物理部署或将整个应用部署到多个节点，但总体而言，粒度太宽。</p>
<p>6、易于开发：高，该模式是众所周知的，并且实现起来也不复杂。</p>
<h2 id="-">事件驱动架构</h2>
<h2 id="-">参考文档</h2>
<p><a href="https://orkhanscience.medium.com/software-architecture-patterns-5-mins-read-e9e3c8eb47d2">https://orkhanscience.medium.com/software-architecture-patterns-5-mins-read-e9e3c8eb47d2</a></p>
<p><a href="https://www.oreilly.com/content/software-architecture-patterns/">https://www.oreilly.com/content/software-architecture-patterns/</a></p>
</body>
</html>
