<!DOCTYPE html>
<html>
<head>
  <title>BrowserWindow</title>
  <link rel="stylesheet" href="/note/note.css?ts=1645456638699">
<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0"><link rel="shortcut icon" href="/ico.png"></head>
<body><script>var _hmt = _hmt || [];
(function () {
    var hm = document.createElement("script");
    hm.src = "https://hm.baidu.com/hm.js?256376ad73e3e50091706bb3c032e74c";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
})();
</script>
<h1 id="browserwindow">BrowserWindow</h1>
<p>进程：主进程。创建并控制浏览器窗口。</p>
<h2 id="-">自定义窗口</h2>
<p>BrowserWindow类暴露了各种方法来修改应用窗口的外观和行为。详细信息，请参考<a href="https://www.electronjs.org/zh/docs/latest/tutorial/window-customization">自定义窗口</a>。</p>
<h2 id="-">优雅地显示窗口</h2>
<p>每次加载页面都是直接展示，用户突然就看到了，这体验很不好。可以用以下两种解决方案。</p>
<h3 id="-ready-to-show-">使用ready-to-show事件</h3>
<p>在加载页面时，渲染进程第一次完成绘制时，如果窗口没有被显示，渲染进程会发出ready-to-show事件。</p>
<pre><code class="lang-js"><div class="highlight"><pre>  <span class="kr">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span>
    <span class="nx">width</span><span class="o">:</span> <span class="mi">800</span><span class="p">,</span>
    <span class="nx">height</span><span class="o">:</span> <span class="mi">600</span><span class="p">,</span>
    <span class="nx">webPreferences</span><span class="o">:</span> <span class="p">{</span>
      <span class="nx">preload</span><span class="o">:</span> <span class="nx">path</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="nx">__dirname</span><span class="p">,</span> <span class="s1">&#39;preload.js&#39;</span><span class="p">)</span>
    <span class="p">},</span>
    <span class="nx">show</span><span class="o">:</span> <span class="kc">false</span>
  <span class="p">});</span>

  <span class="nx">win</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="nx">win</span><span class="p">.</span><span class="nx">show</span><span class="p">();</span>
  <span class="p">})</span>
</pre></div>

</code></pre>
<p>这个事件通常在did-finish-load事件之后发出，但是页面有许多远程资源时，它可能会在did-finish-load之前发出事件。</p>
<p>注意：此事件意味着渲染器会被认为是可见的并绘制，即使show是false。如果您使用paintWhenInitiallyHidden:false，此事件将不会触发。</p>
<h3 id="-backgroundcolor-">设置backgroundColor属性</h3>
<p>对于一个复杂的应用，ready-to-show可能发出的太晚，会让应用感觉缓慢。这种情况下，可以设置背景色。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kr">const</span> <span class="p">{</span> <span class="nx">BrowserWindow</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span> <span class="nx">backgroundColor</span><span class="o">:</span> <span class="s1">&#39;#2e2c29&#39;</span> <span class="p">})</span>
<span class="nx">win</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="s1">&#39;https://github.com&#39;</span><span class="p">)</span>
</pre></div>

</code></pre>
<h2 id="-">父子窗口</h2>
<p>通过使用parent选项，你可以创建子窗口。child窗口总是显示在top窗口顶部。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kr">const</span> <span class="p">{</span> <span class="nx">BrowserWindow</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>
<span class="kr">const</span> <span class="nx">top</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">()</span>
<span class="kr">const</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span> <span class="nx">parent</span><span class="o">:</span> <span class="nx">top</span> <span class="p">})</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>
<span class="nx">top</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>
</pre></div>

</code></pre>
<h2 id="-">模态窗口</h2>
<p>模态窗口是禁用父窗口的子窗口，创建模态窗口必须设置parent和modal选项。</p>
<pre><code class="lang-js"><div class="highlight"><pre><span class="kr">const</span> <span class="p">{</span> <span class="nx">BrowserWindow</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;electron&#39;</span><span class="p">)</span>

<span class="kr">const</span> <span class="nx">child</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">BrowserWindow</span><span class="p">({</span> <span class="nx">parent</span><span class="o">:</span> <span class="nx">top</span><span class="p">,</span> <span class="nx">modal</span><span class="o">:</span> <span class="kc">true</span><span class="p">,</span> <span class="nx">show</span><span class="o">:</span> <span class="kc">false</span> <span class="p">})</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">loadURL</span><span class="p">(</span><span class="s1">&#39;https://github.com&#39;</span><span class="p">)</span>
<span class="nx">child</span><span class="p">.</span><span class="nx">once</span><span class="p">(</span><span class="s1">&#39;ready-to-show&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="nx">child</span><span class="p">.</span><span class="nx">show</span><span class="p">()</span>
<span class="p">})</span>
</pre></div>

</code></pre>
<h2 id="-">页面可见性</h2>
<p>在所有平台上，可见性状态与窗口是否隐藏和最小化相关。</p>
<p>在macOS上，可见性状态还会跟踪窗口的遮挡状态，如果窗口被另一个窗口完全遮挡了，可见性为hidden。其它平台，只有win.hide()使窗口最小化或隐藏时才为hidden。</p>
<p>创建BrowserWindow时带有show:false的参数，最初的可见性状态将为visible，尽管窗口实际上是隐藏的。</p>
<p>如果backgroundThrottling被禁用，可见性状态将保持visible即使窗口被最小化，遮挡或隐藏。</p>
<p>推荐您在可见性状态为hidden时暂停消耗资源的操作以便减少电力消耗。</p>
<h2 id="-">平台相关的提示</h2>
<p>在macOS上，modal窗口将显示为附加到父窗口的工作表。</p>
<p>在macOS上，子窗口将保持与父窗口的相对位置，而在Windows或linux中，当父窗口移动时子窗口不会移动。</p>
<p>在Linux上，模态窗口的类型更改为dialog。</p>
<p>在Linux上，许多桌面环境不支持隐藏模态窗口。</p>
<h2 id="browserwindow-">BrowserWindow类</h2>
<p>创建并控制浏览器窗口，进程为主进程。BrowserWindow是一个EventEmitter。</p>
<p>new BrowserWindow(options)</p>
<p>options:</p>
<p>1、width，窗口的宽度，以像素为单位，默认800。</p>
<p>2、height，窗口的高度，以像素为单位，默认600。</p>
<p>3、x，相对于屏幕左侧的偏移量，默认窗口居中。</p>
<p>4、y，相对于屏幕顶端的偏移量，默认窗口居中。</p>
<p>注意：x,y需要成对出现才会起作用。</p>
<p>5、useContentSize:boolean，默认为false，width和height将设置为Web页面的尺寸(不包含边框)。</p>
<p>6、center:boolean，是否在屏幕居中。</p>
<p>7、minHeight，minWidth，窗口的最小高度。默认0。</p>
<p>8、maxWidth，maxHeight，默认不限。</p>
<p>9、resizeable:boolean，默认true。</p>
<p>10、movable:boolean，默认true，Linux上未实现。</p>
<p>11、minimizable，默认true，Linux上未实现。</p>
<p>12、maximizable，默认为true，Linux上未实现。</p>
<p>13、closable，默认true，Linux上未实现。</p>
<p>14、focusable，默认true，窗口是否可以聚焦，Windows中设置false意味着skipTaskbar:true，Liunx中设置false时窗口停止与vm交互，并且窗口将始终置顶。</p>
<p>15、alwaysOnTop，默认为false。</p>
<p>16、fullscreen，macOS上明确设置为false时将隐藏全屏按钮。</p>
<p>17、fullscreenable，窗口是否可以进入全屏状态，macOS上，最大化和全屏按钮是否可用。默认值为true。</p>
<p>18、simpleFullscreen，默认false，macOS上使用pre-Lion全屏。</p>
<p>19、skipTaskbar，是否在任务栏中显示窗口，默认为false。</p>
<p>20、kiosk，窗口书否进入kiosk模式，默认为false。</p>
<p>21、title，默认窗口标题，默认为Electron，如果由loadURL加载的HTML文件含有标签title，此属性将忽略。</p>
<p>22、icon，NativeImage|String，在windows上推荐使用ico图标来获得最佳的视觉效果。</p>
<p>23、show，窗口是否在创建时展示。</p>
<p>24、paintWhenInitiallyHidden:boolean，当show为false并且渲染器刚刚被创建时，它是否应绘制。默认为true。</p>
<p>25、frame，boolean，设置为false时创建一个无边框窗口，默认为true。</p>
<p>26、parent，指定父窗口，默认值为null。</p>
<p>27、modal，默认false。</p>
<p>28、acceptFirstMouse，单击非活动窗口是否同时触发点击进入里面的网页内容，macOS上为false。</p>
<p>29、disableAutoHideCursor，默认false，打字时隐藏光标。</p>
<p>30、autoHideMenuBar，默认false，自动隐藏菜单栏。除非按Alt键。</p>
<p>31、enableLargerThanScreen，默认false，仅适用于MacOS，因为其它操作系统默认允许大于屏幕的窗口。</p>
<p>32、backgroundColor，十六进制值，#66CD00，设置transparent为true方可支持alpha属性。</p>
<p>33、hasShadow，默认为true，窗口是否有阴影。</p>
<p>34、opacity，设置窗口初始的不透明度，目前仅支持window和macos。</p>
<p>35、darkTheme，强制窗口使用深色模式。默认为false。只在部分GTL+3桌面环境有效。</p>
<p>36、transparent，默认为false。</p>
<p>37、type:string，默认为普通窗口，更多类型见下文。</p>
<p>38、visualEffectSize:string，指定外观应如何反映macOS上的窗口活动状态，必须与vibrance属性一起使用。</p>
<p>允许的值：followWindow，窗口处于激活状态时，后台应自动显示为激活状态。反之亦然。默认为该值。</p>
<p>active，后台应一直显示为激活状态。</p>
<p>inactive，后台应一直显示为未激活状态。</p>
<p>39、titleBarStyle，可选值macOS或Windows，默认为default，分别返回macos和windows的标准标题栏。</p>
<p>hidden，maxos窗口将一直拥有左上角标准控制器。windows上，与titleBarOverlay:true一起使用时，它将激活窗口空间叠加。否则不会显示窗口控件。</p>
<p>hiddenInset，隐藏标题栏，显示小的控制按钮在窗口边缘。</p>
<p>customButtonOnHover，仅在macOS上，才会出现隐藏的标题栏和全尺寸的内容窗口，当在窗口左上角hover时，显示小的控制按钮。</p>
<p>40、trafficLightPosition，控制按钮在无边框窗口中的位置。</p>
<p>41、roundedCorners，默认true，无框窗口在MacOS上是否圆角。</p>
<p>42、thickFrame，对windows上的无框窗口使用WS_THICKFRAME样式，会增加标准窗口框架。默认true，设置为false移除窗口的阴影和动画。</p>
<p>43、vibrancy，动态效果，仅macOS有效。</p>
<p>44、zoomToPageWidth，，默认false，控制macOS上，为true，窗口放大到页面的宽度，为false，放大到屏幕的宽度。</p>
<p>45、tabbingIdentifier，macOS的 10.12+上可使窗口在原生选项卡中打开，具有相同标识符的窗口将组合在一起。还会在窗口的标签栏中添加一个新选项卡按钮，允许app和窗口接收new-window-for-tab事件。</p>
<p>46、webPreferences：属性比较多。</p>
<p>47、webPreferences.devTools:boolean，是否开启DevTools，如果设置为false，则无法使用win.webContents.openDevTools打开DevTools，默认true。</p>
<p>48、webPreferences.nodeIntegration:boolean，是否启用node集成。默认false。</p>
<p>49、webPreferences.nodeIntegrationInWorker:boolean，是否在Web Worker中启用Node集成。默认false。</p>
<p>50、webPreferences.nodeIntegrationInSubFrames:boolean，是否允许子页面iframe或子窗口中集成Node，预加载的脚本会被注入到每一个iframe，可以使用process.isMainFrame来判断当前是否在主框架中。</p>
<p>51、webPreferences.preload:string，页面运行其它脚本之前预先加载指定的脚本，无论页面是否集成Node，此脚本都可以访问所有Node API。当Node integration关闭时，预加载的脚本将从全局范围重新引入node的全局引用标志。</p>
<p>52、webPreferences.sandbox:boolean，如果设置该参数，沙箱的渲染器将与窗口关联，使它与Chromium OS-level的沙箱兼容，并禁用Node.js引擎。且预加载的脚本的API也有限制。</p>
<p>53、webPreferences.session，设置页面的session，可以用partition选项来代替。同时设置了session和partition字符串，session的优先级更高。</p>
<p>54、webPreferences.partition，通过session的partition字符串来设置界面session。</p>
<p>55、webPreferences.zoomFactor:number，默认值1.0，页面的缩放系数。</p>
<p>56、webPreferences.javascript:boolean，是否启用JS，默认true。</p>
<p>57、webPreferences.webSecurity:boolean，设置false，禁用同源策略，默认为true。</p>
<p>58、allowRunningInsecureContent:boolean，默认false，允许一个https页面运行来自http url的JS，CSS或plugins。</p>
<p>59、images:boolean，是否允许记载图片，默认true。</p>
<p>60、imageAnimationPolicy:string，指定如何运行图像动画。可以是animate，animateOnce或noAnimation，默认值为animate。</p>
<p>61、textAreasAreResizable，默认true。</p>
<p>62、webgl:boolean，默认true，是否启用WebGL。</p>
<p>63、plugins:boolean，是否启用plugins，默认false。</p>
<p>64、experimentalFeatures，默认false。</p>
<p>65、scrollBounce，默认false，在macOS上启用弹力动画。</p>
<p>66、enableBlinkFeaturesString，逗号分隔的需要启用的特性列表。</p>
<p>67、disableBlinkFeatures，逗号分隔的需要禁用的特性列表。</p>
<p>68、defaultFontFamily:{standard:string,serif,sansSerif,monospace,cursive,fantasy}。</p>
<p>69、defaultFontSize，默认为16。</p>
<p>70、defaultMonospaceFontSize，默认为13。</p>
<p>71、minimumFontSize，默认为0。</p>
<p>72、defaultEncoding，默认为ISO-8859-1。</p>
<p>73、backgroundThrottling:boolean，是否页面不展示时限制动画和计时器。默认true。</p>
<p>74、offscreen，是否绘制和渲染可视区域外的窗口，默认值为false。</p>
<p>75、contextIsolation:boolean，默认true。是否在独立的JS环境中运行Electron API和指定的preload脚本。</p>
<p>预加载脚本所运行的上下文环境只能访问其自身专用的docuemnt和window属性，其自身一系列内置的JS对象。这写对于已加载的JS是不可见的。</p>
<p>Electron API只在预加载脚本中可用，在已加载脚本中不可用。该选项使用的是与Chrome内容脚本相同的技术。可以在devTools的Electron Isolated Context条目来访问这个上下文。</p>
<p>76、nativeWindowOpen，是否使用原生的window.open，默认true。</p>
<p>77、webviewTag，是否启用webview tag标签，默认false。注意，webview配置的preload脚本在执行时会启用nodeIntegration，应确保远程或不受信任的内容无法创建恶意的preload脚本。可以使用webContents上的will-attach-webview事件对preload脚本进行剥离，并验证和更改webview的初始设置。</p>
<p>注意，webviewTag不建议使用。</p>
<p>78、additionalArguments，当前应用程序的渲染器进程中process.argv的字符串列表。主要用于传递少部分数据到渲染器进程。</p>
<p>79、safeDialogs，是否启用浏览器样式的持续对话框保护，默认false。</p>
<p>80、safeDialogsMessage，安全对话框展示的消息。</p>
<p>81、disableDialogs，默认false。</p>
<p>82、navigateOnDragDrop，将文件或链接拖放到页面是否触发页面跳转，默认false。</p>
<p>83、autoplayPolicy，自动播放策略，值可以是no-user-gesture-required，user-gesture-required，document-user-activation-required。 默认是no-user-gesture-required。</p>
<p>84、disableHtmlFullscreenWindowResize:boolean，默认值false。</p>
<p>85、accessibleTitle，提供给屏幕阅读器等辅助工具的替代标题字符串，对用户不直接可见。</p>
<p>86、spellcheck，是否启用拼写检查器，默认true。</p>
<p>87、enableWebSQL，默认true，是否启用WebSQL api。</p>
<p>88、v8CacheOptions:string，强制blink使用V8代码缓存策略。</p>
<p>none，禁用代码缓存。</p>
<p>code，基于启发式代码缓存。</p>
<p>bypassHeatCheck，绕过启发式代码缓存，但使用懒编译。</p>
<p>bypassHeatCheckAndEagerCompile，编译是及时的，默认策略是code。</p>
<p>89、enablePreferredSizeMode，是否启用首选大小模式。首选大小是包含文档布局所需的最小大小，默认false。</p>
<p>90、titleBarOverlay:boolean|object，当使用无框窗口配置。默认为false。</p>
<p>当使用minWidth/maxWidth/minHeight/maxHeight设置最小或最大窗口时，它只限制用户，它不会阻止你将不符合大小限制的值传递给setBounds和setSize或BrowserWindow的构造函数。</p>
<p>type的选项与平台相关：</p>
<p>Linux上，可能为desktop，dock，toolbar，splash，notification。</p>
<p>MaxOS上，可能的类型为desktop，textured。</p>
<p>Windows上，可能的的类型为toolbar。</p>
</body>
</html>
